<!-- dragable-table-component.html -->

<mat-table
  #table
  [dataSource]="dataSource"
  class="mat-elevation-z8"
  cdkDropList
  [cdkDropListData]="dataSource"
  (cdkDropListDropped)="drop($event)"
>
  @for (col of displayedColumns; track col) {
    <ng-container [matColumnDef]="col">
      <mat-header-cell *matHeaderCellDef>
        {{ formatHeader(col) }}
      </mat-header-cell>

      <mat-cell *matCellDef="let row">
        @if (col === displayedColumns[0]) {
          <mat-icon class="example-drag-cursor">reorder</mat-icon>
        }
        {{ formatCell(row[col]) }}
      </mat-cell>
    </ng-container>
  }

  <mat-header-row *matHeaderRowDef="displayedColumns"></mat-header-row>

  <mat-row
    *matRowDef="let row; columns: displayedColumns"
    cdkDrag
    [cdkDragData]="row"
  ></mat-row>
</mat-table>
